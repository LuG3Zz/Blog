/**
 * 自定义 KaTeX 样式
 * 修复下标显示位置问题
 */

/* 确保下标正确显示 */
.katex .msupsub {
  text-align: left;
}

/* 修复下标位置 */
.katex .msupsub .msubsup {
  display: inline-flex;
  flex-direction: column;
  text-align: left;
}

/* 修复上标位置 */
.katex .msupsub .msup {
  display: block;
  position: relative;
  top: -0.5em;
  left: 0;
  vertical-align: top;
}

/* 修复下标位置 */
.katex .msupsub .msub {
  display: block;
  position: relative;
  top: 0.5em;
  left: 0;
  vertical-align: bottom;
}

/* 确保分数正确显示 */
.katex .mfrac {
  display: inline-block;
  vertical-align: middle;
}

/* 确保根号正确显示 */
.katex .sqrt {
  display: inline-block;
  vertical-align: middle;
}

/* 确保行内公式垂直对齐 */
.katex-display {
  display: block;
  margin: 1em 0;
  text-align: center;
}

.katex-inline {
  display: inline-block;
  vertical-align: middle;
  line-height: normal;
}

/* 确保公式不会被截断 */
.katex-display > .katex {
  display: inline-block;
  text-align: center;
  max-width: 100%;
}

/* 允许公式水平滚动 */
.katex-display > .katex > .katex-html {
  display: block;
  position: relative;
  overflow-x: auto;
  overflow-y: hidden;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
}

/* 确保暗黑模式下公式颜色正确 */
.dark .katex {
  color: #e2e8f0;
}
